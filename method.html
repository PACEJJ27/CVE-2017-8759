<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305682 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 18pt;
    }
  </style>
</head>
<body>
<a name="1027"/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;line-height:1.15;text-size-adjust:100%;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;font-family:&quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif;font-size:12px;line-height:1.5;color:rgb(101, 113, 128);background-color:rgb(255, 255, 255);-webkit-font-smoothing:antialiased;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;zoom:1;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;"><h1 style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;font-size:34px;font-weight:700;line-height:44px;color:rgb(34, 34, 34);">最新CVE-2017-8759漏洞复现的两种姿势</h1> <div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;margin-top:12px;margin-bottom:20px;font-size:13px;"> <span style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;color:rgb(119, 119, 119);margin-right:2px;">华盟黑白之道</span> <span style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;color:rgb(119, 119, 119);margin-right:2px;">2017-09-18 11:17</span></div> <div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;margin-bottom:24px;font-size:16px;line-height:28px;color:rgb(34, 34, 34);word-wrap:break-word;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;font-size:16px;line-height:28px;color:rgb(34, 34, 34);word-wrap:break-word;"><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">大家好，我是你们的老朋友Alex。今天教大家复现漏洞CVE-2017-8759</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">https://github.com/vysec/CVE-2017-8759</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">该漏洞影响所有主流的.NETFramework版本</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework4.6.2</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework4.6.1</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework3.5.1</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework4.7</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework4.6</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework4.5.2</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework3.5</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Microsoft .NET Framework 2.0 SP2</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">详细漏洞细节链接：http://www.freebuf.com/articles/system/147602.html</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">环境：</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Kali linux IP： 192.168.1.118</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">Win8.1靶机 IP： 192.168.1.19 （OFFICE2013）</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">在kali中使用Empire生成HTA后门</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3aff0003cde6268885f5.jpg" type="image/jpeg" data-filename="3aff0003cde6268885f5.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="306" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">修改exploit.txt文件</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3afc0003df26fca1609e.jpg" type="image/jpeg" data-filename="3afc0003df26fca1609e.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="218" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">开启apache或者使用python -m SimpleHTTPServer建立链接</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3aff0003cde48d108bbc.jpg" type="image/jpeg" data-filename="3aff0003cde48d108bbc.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="60" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">并且把HTA上传到同一路径下。</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">然后使用word新建一个rtf，插入一个链接到文件的对象http://192.168.1.118:808/exploit.txt</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3b000003b0448d66c21b.jpg" type="image/jpeg" data-filename="3b000003b0448d66c21b.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="382" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">然后使用C32编辑blob.bin，修改位置如下</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3b0200023623cb1351f7.jpg" type="image/jpeg" data-filename="3b0200023623cb1351f7.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="773" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="638"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">右键拷贝HEX格式所有，使用编辑器打开rtf文件替换代码</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3aff0003cde7c0c2acf2.jpg" type="image/jpeg" data-filename="3aff0003cde7c0c2acf2.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="188" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">再将objautlink前插入objupdate</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3aff0003cde847212704.jpg" type="image/jpeg" data-filename="3aff0003cde847212704.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="170" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">保存修改后我们测试一下效果！</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3afd0003d8d9a03dc2bd.jpg" type="image/jpeg" data-filename="3afd0003d8d9a03dc2bd.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="153" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">(o゜▽゜)o☆[BINGO!]</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;"><img src="最新CVE-2017-8759漏洞复现的两种姿势_files/3b000003b04eb0ab2184.jpg" type="image/jpeg" data-filename="3b000003b04eb0ab2184.jpg" alt="最新CVE-2017-8759漏洞复现的两种姿势" height="215" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;border-style:none;max-width:100%;display:block;margin:10px auto;" width="640"/></p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">还有一种利用姿势就是使用宏来加载HTA文件，项目地址：</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">https://github.com/Voulnet/CVE-2017-8759-Exploit-sample</p><p style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:0px;margin:16px 0px;">ByeBye~</p></div></div> <div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:block;zoom:1;margin-bottom:28px;"><span style="display:table;"></span><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;float:left;"><i style="font-variant-ligatures:normal;-webkit-tap-highlight-color:transparent;box-sizing:border-box;font-size:21px;text-transform:none;display:inline-block;speak:none;font-weight:400;font-style:normal;font-variant-caps:normal;line-height:1;text-rendering:auto;-webkit-font-smoothing:antialiased;vertical-align:middle;font-family:tticons;color:rgb(202, 202, 202);"><span style="font-style:normal;font-size:12px;line-height:1;font-weight:400;text-transform:none;font-family:tticons;"></span></i> <ul style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;list-style:none;display:inline-block;vertical-align:middle;"><li style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;margin-right:8px;font-size:14px;"><span style="font-size:14px;padding-right:10px;color:rgb(224, 224, 224);"></span><a href="http://www.toutiao.com/search/?keyword=Linux" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;background:0px 0px;text-decoration:none;outline:0px;cursor:pointer;transition:color 0.2s ease;color:rgb(64, 101, 153);" target="_blank">Linux</a></li><li style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;margin-right:8px;font-size:14px;"><span style="font-size:14px;padding-right:10px;color:rgb(224, 224, 224);">/</span><a href="http://www.toutiao.com/search/?keyword=Word" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;background:0px 0px;text-decoration:none;outline:0px;cursor:pointer;transition:color 0.2s ease;color:rgb(64, 101, 153);" target="_blank">Word</a></li><li style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;margin-right:8px;font-size:14px;"><span style="font-size:14px;padding-right:10px;color:rgb(224, 224, 224);">/</span><a href="http://www.toutiao.com/search/?keyword=Apache" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;background:0px 0px;text-decoration:none;outline:0px;cursor:pointer;transition:color 0.2s ease;color:rgb(64, 101, 153);" target="_blank">Apache</a></li><li style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;margin-right:8px;font-size:14px;"><span style="font-size:14px;padding-right:10px;color:rgb(224, 224, 224);">/</span><a href="http://www.toutiao.com/search/?keyword=Python" style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;background:0px 0px;text-decoration:none;outline:0px;cursor:pointer;transition:color 0.2s ease;color:rgb(64, 101, 153);" target="_blank">Python</a></li></ul></div> <div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;float:right;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;cursor:pointer;line-height:18px;"><i style="font-variant-ligatures:normal;-webkit-tap-highlight-color:transparent;box-sizing:border-box;font-size:18px;text-transform:none;display:inline-block;speak:none;font-weight:400;font-style:normal;font-variant-caps:normal;line-height:1;text-rendering:auto;-webkit-font-smoothing:antialiased;width:18px;vertical-align:middle;font-family:tticons;color:rgb(255, 189, 29);"><span style="font-style:normal;font-size:12px;line-height:1;font-weight:400;text-transform:none;font-family:tticons;"></span></i><span style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;color:rgb(153, 153, 153);font-size:14px;padding-left:7px;vertical-align:middle;">收藏</span></div> <div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;margin-left:10px;"><div style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;margin:0px;padding:0px;display:inline-block;cursor:pointer;line-height:18px;"><i style="font-variant-caps:normal;-webkit-tap-highlight-color:transparent;box-sizing:border-box;font-size:14px;text-rendering:auto;display:inline-block;speak:none;font-weight:400;font-variant-ligatures:normal;font-style:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;vertical-align:middle;width:14px;margin-right:7px;font-family:tticons;color:rgb(202, 202, 202);"><span style="font-style:normal;font-size:12px;line-height:1;font-weight:400;text-transform:none;font-family:tticons;"></span></i><span style="-webkit-tap-highlight-color:transparent;box-sizing:border-box;color:rgb(153, 153, 153);font-size:14px;vertical-align:middle;">举报</span></div> </div></div><span style="display:block;visibility:hidden;font-size:0px;height:0px;clear:both;"></span></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 
